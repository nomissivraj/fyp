<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Vocal Developer</title>
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script src="node_modules/jquery/dist/jquery.min.js"></script>
        <script src="scripts/funcs.js"></script>
    </head>
    <body class="gui-editor">
        <header class="app-header">
            <div class="app-toolbar">
                <div class="app-toolbar__icon">
                    <img src="img/app-icon-64x64.png" alt="Vocal Developer Icon">
                </div>
                <div class="app-toolbar__menu">
                    <ul class="dropdown__menu">
                        <li class="dropdown__item">
                            <button class="dropdown__filebtn" onclick="toggleDisplay('dropdown__filemenu')">File</button>
                            <div id="dropdown__filemenu" style="display: none">
                                <ul class="submenu">
                                    <li>
                                        <button id="savebtn">
                                            <span class="submenu__item-title">Save</span>
                                            <span class="submenu__item-shortcut">Shortcut</span>
                                        </button>
                                    </li>
                                    <li>
                                        <button>Other</button>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                    
                </div>
                <div class="app-toolbar__title">
                    <span>Vocal Developer</span>
                </div>
                <div class="app-toolbar__options">
                    <div id="min-btn" class="options__minimise">
                        <img src="img/app-min.svg" width="12px" alt="minimise window icon">
                    </div>
                    <div id="max-btn" class="options__maximise">
                        <img src="img/app-max.svg" width="12px" alt="maximise window icon">
                    </div>
                    <div id="restore-btn" class="options__restore">
                        <img src="img/app-restore.svg" width="12px" alt="restore window icon">
                    </div>
                    <div id="close-btn" class="options__close">
                        <img src="img/app-close.svg" width="12px" alt="close window icon">
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div id="gui-sidebar">
                <div id="step one">step one</div>
                <div id="step one">step two</div>
                <div id="step one">step three</div>
            </div>
            <div id="editor">
                <iframe></iframe>
            </div>
        </main>
        
    </body>
    <script>
        require('./scripts/renderer.js');
        const electron = require('electron');
        const {ipcRenderer} = electron;
        const remote = require('electron').remote;
        const app = remote.app;
        const path = require('path');
        const fs = require('file-system');
        const savesPath = path.join(app.getPath('documents'),'Vocal Developer Projects','/saves/');
        ipcRenderer.send('ready:gui-window');

        setTimeout(() => {
            const iframe = document.getElementsByTagName('iframe')[0];
            const iframeDoc = iframe.contentWindow.document;

            const iframeDocEl = iframe.contentWindow.document.documentElement;
            const iframeBody = iframeDoc.getElementsByTagName('body');

            let styleTag = iframeDoc.createElement('style');
            styleTag.innerHTML = `
                ::-webkit-scrollbar {
                    width: 10px;
                }
                
                ::-webkit-scrollbar-track {
                    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
                    box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
                    background-color:rgba(255, 255, 255, 0.24);
                }
                
                ::-webkit-scrollbar-thumb {
                background-color: #d1d1d19d;
                background: linear-gradient(#d1d1d149, #ffffff94, #d1d1d149);
                outline: 1px solid #e87400;
                }
            `
            iframeDocEl.appendChild(styleTag);
            console.log(iframeDoc)
        }, 100);
        
        /*  */
        
        //Recieve
        ipcRenderer.on('load:data', (e, data) => {
            fs.readFile(savesPath+data.name+'/index.html','utf-8',(err, fileData) => {
                if (err) return console.log(err);
                /* console.log(fileData); */
                
            });
            /* console.log(data); */
            let iframe = document.querySelector('iframe');
                iframe.src = savesPath+data.name+'/index.html';
        })
    </script>
</html>